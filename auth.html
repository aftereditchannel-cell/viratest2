<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ورود | ویرا استایل</title>

<link rel="stylesheet" href="auth.css">
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;600;700&display=swap" rel="stylesheet">

</head>
<body>

<div class="bg-glow"></div>

<div class="auth-card">
    <div class="logo">V</div>
    <h1>ویرا استایل</h1>
    <p class="subtitle">همراه هوشمند انتخاب استایل شما</p>

    <!-- دکمه گوگل واقعی -->
    <button class="btn google" onclick="window.location.href='https://viratest2.onrender.com/auth/google'">
        <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/google/google-original.svg" alt="Google Logo">
        ثبت نام با گوگل
    </button>

    <div class="divider"><span>یا</span></div>
    
    <!-- ورود مهمان -->
    <button class="btn guest" id="guestLogin">
        ورود آزمایشی (مهمان)
    </button>

    <p class="terms">
        با ادامه شما قوانین و حریم خصوصی را می‌پذیرید
    </p>
</div>

<script src="auth.js"></script>

<script>
// ورود مهمان
document.getElementById("guestLogin").onclick = () => {
    const user = {
        type: "guest",
        name: "کاربر مهمان",
        id: "guest_" + Date.now(),
        login: new Date().toISOString()
    };
    localStorage.setItem("vira_session", JSON.stringify(user));
    window.location.href = "home.html";
};

// خواندن اطلاعات کاربر واقعی گوگل بعد از Redirect از Render
window.addEventListener('DOMContentLoaded', () => {
    const urlParams = new URLSearchParams(window.location.search);
    const userStr = urlParams.get('user');
    if(userStr){
        try {
            const user = JSON.parse(decodeURIComponent(userStr));
            localStorage.setItem("vira_session", JSON.stringify(user));
            // بعد از ذخیره، به صفحه اصلی بروید
            window.location.href = "home.html";
        } catch(e){
            console.error("مشکل در خواندن اطلاعات کاربر گوگل:", e);
        }
    }
});
</script>

</body>
</html>
